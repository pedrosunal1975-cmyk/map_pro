# ==============================================================================
# MAP PRO - CONSOLIDATED ENVIRONMENT CONFIGURATION
# ==============================================================================
# Location: /home/a/Desktop/Stock_software/map_pro/.env
#
# This is the master configuration file for all MAP PRO modules:
# - searcher, database, downloader, library, parser, mapper
#
# All modules read from this file unless they have their own local .env
# ==============================================================================

# ==============================================================================
# SHARED DATABASE CONFIGURATION (All Modules)
# ==============================================================================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=xbrl_coordination
DB_USER=a
DB_PASSWORD=malafat74

# Database Connection Pool Settings
DB_POOL_SIZE=5
DB_POOL_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ==============================================================================
# SHARED DATA PATHS (All Modules)
# ==============================================================================
# Where entity filing data is stored (shared across all modules)
DATA_ENTITIES_DIR=/mnt/map_pro/downloader/entities

# Where standard taxonomy libraries are stored (shared across all modules)
DATA_TAXONOMIES_DIR=/mnt/map_pro/taxonomies/libraries

# ==============================================================================
# SEARCHER MODULE CONFIGURATION
# ==============================================================================
# Directory Paths
SEARCHER_ROOT_DIR=/mnt/map_pro/searcher
SEARCHER_LOG_DIR=/mnt/map_pro/searcher/logs
SEARCHER_CACHE_DIR=/mnt/map_pro/searcher/cache
SEARCHER_EXPORT_DIR=/mnt/map_pro/searcher/exports

# General API Configuration
SEARCHER_API_TIMEOUT=30
SEARCHER_API_RETRY_COUNT=3
SEARCHER_MAX_CONCURRENT_REQUESTS=3
SEARCHER_MAX_RESULTS=100
SEARCHER_DEFAULT_LOOKBACK_DAYS=365

# Logging Configuration
SEARCHER_LOG_LEVEL=INFO
SEARCHER_LOG_CONSOLE=true
SEARCHER_STORE_RAW_RESPONSES=false

# Cache Configuration
SEARCHER_ENABLE_CACHE=true
SEARCHER_CACHE_EXPIRY_HOURS=24

# SEC-Specific Configuration
SEARCHER_SEC_USER_AGENT=MapProAnalyzer/1.0 (baftan_sowibat@proton.me)
SEARCHER_SEC_BASE_URL=https://data.sec.gov
SEARCHER_SEC_RATE_LIMIT=10
SEARCHER_SEC_TIMEOUT=30
SEARCHER_SEC_RETRY_ATTEMPTS=3
SEARCHER_SEC_COMPANY_TICKERS_URL=https://www.sec.gov/files/company_tickers.json
SEARCHER_SEC_SUBMISSIONS_URL=https://data.sec.gov/submissions/CIK{cik}.json
SEARCHER_SEC_FACTS_URL=https://data.sec.gov/api/xbrl/companyfacts/CIK{cik}.json
SEARCHER_SEC_ARCHIVES_BASE_URL=https://www.sec.gov/Archives/edgar/data/

# UK Companies House Configuration
SEARCHER_UK_CH_API_KEY=eb8344c6-5e4a-4c2d-b250-24b0d59bf5c1
SEARCHER_UK_CH_USER_AGENT=MapProAnalyzer/1.0 (baftan_sowibat@proton.me)
SEARCHER_UK_CH_BASE_URL=https://api.companieshouse.gov.uk
SEARCHER_UK_CH_COMPANY_URL=https://api.companieshouse.gov.uk/company/{company_number}
SEARCHER_UK_CH_FILING_HISTORY_URL=https://api.companieshouse.gov.uk/company/{company_number}/filing-history
# Document API (different from Company API!)
SEARCHER_UK_CH_DOCUMENT_META_URL=https://document-api.company-information.service.gov.uk/document/{document_id}
SEARCHER_UK_CH_DOCUMENT_CONTENT_URL=https://document-api.company-information.service.gov.uk/document/{document_id}/content
SEARCHER_UK_CH_RATE_LIMIT=600
SEARCHER_UK_CH_TIMEOUT=30
SEARCHER_UK_CH_DOWNLOAD_TIMEOUT=120
SEARCHER_UK_CH_MAX_RETRIES=3
SEARCHER_UK_CH_RETRY_DELAY=2
SEARCHER_UK_CH_BACKOFF_FACTOR=2

# ESEF/UKSEF Configuration (filings.xbrl.org)
SEARCHER_ESEF_BASE_URL=https://filings.xbrl.org
SEARCHER_ESEF_USER_AGENT=MapProAnalyzer/1.0 (baftan_sowibat@proton.me)
SEARCHER_ESEF_TIMEOUT=30
SEARCHER_ESEF_MAX_RETRIES=3
SEARCHER_ESEF_RETRY_DELAY=2
SEARCHER_ESEF_BACKOFF_FACTOR=2

# Operational Settings
SEARCHER_AUTO_RETRY=true
SEARCHER_RATE_LIMIT_DELAY=1.0

# ==============================================================================
# DOWNLOADER MODULE CONFIGURATION
# ==============================================================================
# Directory Paths
DOWNLOADER_ROOT_DIR=/mnt/map_pro/downloader
DOWNLOADER_ENTITIES_DIR=/mnt/map_pro/downloader/entities
DOWNLOADER_TEMP_DIR=/mnt/map_pro/downloader/temp
DOWNLOADER_LOG_DIR=/mnt/map_pro/downloader/logs
DOWNLOADER_CACHE_DIR=/mnt/map_pro/downloader/cache

# Download Configuration
DOWNLOADER_REQUEST_TIMEOUT=300
DOWNLOADER_CONNECT_TIMEOUT=30
DOWNLOADER_READ_TIMEOUT=300
DOWNLOADER_RETRY_ATTEMPTS=3
DOWNLOADER_RETRY_DELAY=2
DOWNLOADER_MAX_RETRY_DELAY=60
DOWNLOADER_MAX_CONCURRENT=3
DOWNLOADER_CHUNK_SIZE=8192
DOWNLOADER_ENABLE_RESUME=true

# Extraction Configuration
DOWNLOADER_MAX_ARCHIVE_SIZE=524288000
DOWNLOADER_VERIFY_EXTRACTION=true
DOWNLOADER_PRESERVE_ZIP=false
DOWNLOADER_MAX_EXTRACTION_DEPTH=25

# Validation Configuration
DOWNLOADER_MIN_FILE_SIZE=100
DOWNLOADER_VERIFY_CHECKSUMS=true
DOWNLOADER_VERIFY_URL_BEFORE_DOWNLOAD=true

# Logging Configuration
DOWNLOADER_LOG_LEVEL=INFO
DOWNLOADER_LOG_CONSOLE=true
DOWNLOADER_STORE_RAW_RESPONSES=false
DOWNLOADER_LOG_PROGRESS_INTERVAL=100

# Cleanup Configuration
DOWNLOADER_CLEANUP_TEMP_ON_START=true
DOWNLOADER_CLEANUP_FAILED_DOWNLOADS=true
DOWNLOADER_TEMP_RETENTION_HOURS=0

# Operational Settings
DOWNLOADER_AUTO_RETRY=true
DOWNLOADER_VERIFY_FILES_EXIST=true
DOWNLOADER_MAX_SEARCH_DEPTH=10

# SEC-Specific Settings
DOWNLOADER_SEC_USER_AGENT=MapProDownloader/1.0 (baftan_sowibat@proton.me)

# ==============================================================================
# DATABASE MODULE CONFIGURATION
# ==============================================================================
# Directory Paths
DB_ROOT_DIR=/mnt/map_pro/database
DB_POSTGRESQL_DATA_DIR=/mnt/map_pro/database/postgres
DB_LOG_DIR=/mnt/map_pro/database/logs

# Logging Configuration
DB_LOG_LEVEL=INFO
DB_LOG_CONSOLE=true

# Migration Settings
DB_SCHEMA_VERSION=v1.0.0
DB_AUTO_MIGRATE=false

# Operational Settings
DB_VERIFY_FILE_EXISTENCE=true
DB_MAX_SEARCH_RESULTS=1000
DB_CLEANUP_SEARCH_DAYS=90

# ==============================================================================
# LIBRARY MODULE CONFIGURATION
# ==============================================================================
# Taxonomy Data Paths
LIBRARY_TAXONOMIES_ROOT=/mnt/map_pro/taxonomies
LIBRARY_TAXONOMIES_LIBRARIES=/mnt/map_pro/taxonomies/libraries
LIBRARY_TAXONOMIES_DIR=/mnt/map_pro/taxonomies/libraries
LIBRARY_PARSED_FILES_DIR=/mnt/map_pro/parser/parsed_reports
LIBRARY_MANUAL_DOWNLOADS=/mnt/map_pro/taxonomies/manual_downloads
LIBRARY_MANUAL_PROCESSED=/mnt/map_pro/taxonomies/manual_processed

# Working Directories
LIBRARY_CACHE_DIR=/mnt/map_pro/taxonomies/cache
LIBRARY_TEMP_DIR=/mnt/map_pro/taxonomies/temp
LIBRARY_LOG_DIR=/mnt/map_pro/taxonomies/logs

# Library Behavior Settings
LIBRARY_MONITOR_INTERVAL=60
LIBRARY_AUTO_CREATE=true
LIBRARY_MIN_FILES_THRESHOLD=10
LIBRARY_CACHE_TTL=3600
LIBRARY_MAX_RETRIES=3

# ==============================================================================
# PARSER MODULE CONFIGURATION
# ==============================================================================
# Base Paths
PARSER_DATA_ROOT=/mnt/map_pro/parser
PARSER_LOADERS_ROOT=/mnt/map_pro

# Environment & Debug
PARSER_ENVIRONMENT=development
PARSER_DEBUG=false
PARSER_ENABLE_PROFILING=false

# Input Paths (Read-Only)
PARSER_XBRL_FILINGS_PATH=${PARSER_LOADERS_ROOT}/downloader/entities
PARSER_TAXONOMY_PATH=${PARSER_LOADERS_ROOT}/taxonomies/libraries

# Output Paths
PARSER_OUTPUT_DIR=${PARSER_DATA_ROOT}
PARSER_OUTPUT_PARSED_DIR=${PARSER_OUTPUT_DIR}/parsed_reports

# Cache & Temporary Paths
PARSER_TAXONOMY_CACHE_DIR=${PARSER_DATA_ROOT}/cache/taxonomies
PARSER_TAXONOMY_CACHE_DB=${PARSER_TAXONOMY_CACHE_DIR}/taxonomy_cache.db
PARSER_ENABLE_TAXONOMY_CACHING=true
PARSER_TAXONOMY_CACHE_SIZE_MB=1024
PARSER_TAXONOMY_CACHE_TTL_HOURS=168

# Indexing & Query System
PARSER_ENABLE_INDEXING=true
PARSER_INDEX_BATCH_SIZE=1000
PARSER_INDEX_COMPRESSION=true

# Logging Configuration
PARSER_LOG_DIR=${PARSER_DATA_ROOT}/logs
PARSER_LOG_FORMAT=json
PARSER_LOG_ROTATION=daily
PARSER_LOG_RETENTION_DAYS=30
PARSER_LOG_MAX_SIZE_MB=10
PARSER_LOG_BACKUP_COUNT=5
PARSER_LOG_LEVEL=INFO
PARSER_MAIN_LOG=parser.log
PARSER_SYSTEM_LOG=system.log
PARSER_INPUT_LOG=input.log
PARSER_ERROR_LOG=parser_error.log
PARSER_WARNING_LOG=parser_warning.log
PARSER_DEBUG_LOG=parser_debug.log
PARSER_STRUCTURED_LOGGING=true
PARSER_LOG_COMPRESS_ARCHIVED=true

# Parser Configuration
PARSER_MAX_MEMORY_MB=4096
PARSER_ENABLE_STREAMING=true
PARSER_STREAMING_THRESHOLD_MB=50
PARSER_STREAMING_BATCH_SIZE=1000
PARSER_TIMEOUT_SECONDS=0
PARSER_MAX_CONCURRENT_JOBS=3

# Validation Configuration
PARSER_VALIDATION_LEVEL=full
PARSER_STRICT_MODE=false
PARSER_ENABLE_CALCULATION_VALIDATION=true
PARSER_CALCULATION_TOLERANCE=0.01
PARSER_ENABLE_DIMENSIONAL_VALIDATION=true
PARSER_ENABLE_COMPLETENESS_AUDIT=true
PARSER_MIN_QUALITY_SCORE=70.0

# Market-Specific Configuration
PARSER_DEFAULT_MARKET=sec
PARSER_ENABLE_MARKET_AUTO_DETECTION=true
PARSER_ENABLE_SEC_VALIDATION=true
PARSER_ENABLE_FRC_VALIDATION=true
PARSER_ENABLE_ESMA_VALIDATION=true
PARSER_ENABLE_IFRS_VALIDATION=true

# Taxonomy Sources
PARSER_US_GAAP_URL=https://xbrl.sec.gov/
PARSER_IFRS_URL=https://www.ifrs.org/
PARSER_UK_GAAP_URL=http://xbrl.frc.org.uk/
PARSER_ESEF_URL=https://www.esma.europa.eu/
PARSER_TAXONOMY_DOWNLOAD_TIMEOUT=30
PARSER_TAXONOMY_DOWNLOAD_RETRIES=3

# Performance & Optimization
PARSER_ENABLE_MULTITHREADING=true
PARSER_WORKER_THREADS=0
PARSER_ENABLE_RESULT_CACHING=true
PARSER_RESULT_CACHE_TTL_HOURS=24
PARSER_LAZY_LOAD_TAXONOMIES=true
PARSER_MEMORY_CLEANUP_THRESHOLD_MB=3072

# Error Handling & Recovery
PARSER_CONTINUE_ON_ERROR=true
PARSER_MAX_ERRORS=0
PARSER_ENABLE_ERROR_RECOVERY=true

# Output Configuration
PARSER_OUTPUT_SCHEMA_VERSION=1.0
PARSER_INCLUDE_PROVENANCE=true
PARSER_INCLUDE_STATISTICS=true
PARSER_INCLUDE_VALIDATION_RESULTS=true
PARSER_JSON_PRETTY_PRINT=true
PARSER_JSON_INDENT=2
PARSER_ENABLE_OUTPUT_COMPRESSION=false

# Feature Flags
PARSER_ENABLE_FOOTNOTES=true
PARSER_ENABLE_IXBRL=true
PARSER_ENABLE_TUPLES=true
PARSER_ENABLE_CUSTOM_LINKBASES=true
PARSER_ENABLE_RELATIONSHIP_NETWORKS=true
PARSER_ENABLE_LABEL_EXTRACTION=true
PARSER_ENABLE_REFERENCE_EXTRACTION=true

# Security
PARSER_DISABLE_EXTERNAL_ENTITIES=true
PARSER_MAX_FILE_SIZE_MB=500
PARSER_MAX_XML_DEPTH=100
PARSER_VALIDATE_FILE_SIGNATURES=true

# Observability & Monitoring
PARSER_ENABLE_HEALTH_CHECKS=true
PARSER_HEALTH_CHECK_INTERVAL=60
PARSER_ENABLE_METRICS=true

# ==============================================================================
# MAPPER MODULE CONFIGURATION
# ==============================================================================
# Base Paths
MAPPER_DATA_ROOT=/mnt/map_pro/mapper
MAPPER_LOADERS_ROOT=/mnt/map_pro

# Environment
MAPPER_ENVIRONMENT=development
MAPPER_DEBUG=false
MAPPER_ENABLE_PROFILING=false

# Input Paths (Shared with Parser)
MAPPER_XBRL_FILINGS_PATH=${MAPPER_LOADERS_ROOT}/downloader/entities
MAPPER_TAXONOMY_PATH=${MAPPER_LOADERS_ROOT}/taxonomies/libraries
MAPPER_PARSER_OUTPUT_DIR=${MAPPER_LOADERS_ROOT}/parser/parsed_reports
MAPPER_TAXONOMY_CACHE_DIR=${MAPPER_LOADERS_ROOT}/parser/cache/taxonomies

# Output Paths
MAPPER_OUTPUT_MAPPED_DIR=${MAPPER_DATA_ROOT}/mapped_statements

# Logging
MAPPER_LOG_DIR=${MAPPER_DATA_ROOT}/logs
MAPPER_LOG_FORMAT=json
MAPPER_LOG_ROTATION=daily
MAPPER_LOG_RETENTION_DAYS=30
MAPPER_LOG_MAX_SIZE_MB=10
MAPPER_LOG_BACKUP_COUNT=5
MAPPER_LOG_LEVEL=INFO
MAPPER_MAIN_LOG=mapper.log
MAPPER_STRUCTURED_LOGGING=true
MAPPER_LOG_COMPRESS_ARCHIVED=true

# Mapper Configuration
MAPPER_MAX_MEMORY_MB=4096
MAPPER_MAX_CONCURRENT_JOBS=3
MAPPER_BATCH_SIZE=100
MAPPER_ENABLE_BATCH_PROCESSING=true
MAPPER_CONTINUE_ON_ERROR=true
MAPPER_MAX_ERRORS=0

# Validation
MAPPER_VALIDATION_LEVEL=full
MAPPER_STRICT_MODE=false
MAPPER_ENABLE_OUTPUT_VALIDATION=true
MAPPER_ENABLE_COMPLETENESS_CHECK=true
MAPPER_MIN_COVERAGE_PERCENT=95.0
MAPPER_MIN_QUALITY_SCORE=80.0

# Components
MAPPER_UNIT_CONVERSION_PRECISION=2
MAPPER_ENABLE_FUZZY_MATCHING=false
MAPPER_FUZZY_MATCHING_THRESHOLD=0.85
MAPPER_ENABLE_DIMENSION_HANDLING=true
MAPPER_ENABLE_PERIOD_NORMALIZATION=true

# Output
MAPPER_INCLUDE_METADATA=true
MAPPER_INCLUDE_CONFIDENCE_SCORES=false
MAPPER_INCLUDE_PROVENANCE=true
MAPPER_INCLUDE_COMPARISON_RESULTS=false
MAPPER_JSON_PRETTY_PRINT=true
MAPPER_JSON_INDENT=2

# Performance
MAPPER_ENABLE_MULTITHREADING=true
MAPPER_WORKER_THREADS=0
MAPPER_MEMORY_CLEANUP_THRESHOLD_MB=3072

# Observability
MAPPER_ENABLE_HEALTH_CHECKS=true
MAPPER_HEALTH_CHECK_INTERVAL=60
MAPPER_ENABLE_METRICS=false
MAPPER_METRICS_FORMAT=json

# Advanced
MAPPER_ENABLE_EXPERIMENTAL_FEATURES=false
MAPPER_ENABLE_DEBUG_ARTIFACTS=false
MAPPER_DEBUG_ARTIFACTS_DIR=${MAPPER_DATA_ROOT}/debug

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================
